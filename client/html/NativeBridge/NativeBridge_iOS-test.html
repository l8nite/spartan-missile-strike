<html>
	<head>
		<title>NativeBridge_iOS Test</title>
		<link rel="stylesheet" href="../qunit/qunit.css">
	</head>
	<body>
		<div id="qunit"></div>
		<div id="qunit-fixture"></div>
		<script src="../qunit/qunit.js"></script>
		<script src="NativeBridge_Abstract.js"></script>
		<script src="NativeBridge_iOS.js"></script>
		<script>
			asyncTest("getCurrentLocation()", 2, function () {
				var NativeBridge = new NativeBridge_iOS();
				NativeBridge.getCurrentLocation(function (response) {
					ok(("latitude" in response) && ("longitude" in response), "Correct properties names");
					ok((typeof(response.latitude) == "number") && (typeof(response.longitude) == "number"), "Correct property types");
					start();
				});
			});

			asyncTest("getPreference & setPreference", 2, function () {
				var NativeBridge = new NativeBridge_iOS();
				NativeBridge.setPreference({
					one : "one",
					two : "two"
				});
				NativeBridge.getPreference("one", function (response) {
					ok(response == "one", "First preference set/got correctly");
				});
				NativeBridge.getPreference("two", function (response) {
					ok(response == "two", "Second preference set/got correctly");
				});
			});

			test("appendIframe", function () {
				var NativeBridge = new NativeBridge_iOS();
				var srcStr = "spartan-missile-strike://dummySrc/?arguments={\"some\":\"json\",\"object\":999}";
				NativeBridge._appendIframe(srcStr);
				var iframes = document.getElementsByTagName("iframe");
				for (var i in iframes) {
					if (!isNaN(i) && iframes[i].getAttribute("src") == srcStr && iframes[i].getAttribute("style") == "display: none;") {
						ok(true, "iframe appended correctly");
					}
				}
			});
		</script>
	</body>
</html>